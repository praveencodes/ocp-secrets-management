---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.15.0
  name: secretsmanagementconfigs.secrets-management.openshift.io
spec:
  group: secrets-management.openshift.io
  names:
    kind: SecretsManagementConfig
    listKind: SecretsManagementConfigList
    plural: secretsmanagementconfigs
    shortNames:
    - smc
    singular: secretsmanagementconfig
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.phase
      name: Phase
      type: string
    - jsonPath: .status.plugin.ready
      name: Plugin Ready
      type: boolean
    - jsonPath: .status.detectedOperators.certManager.installed
      name: cert-manager
      type: boolean
    - jsonPath: .status.detectedOperators.externalSecrets.installed
      name: ESO
      type: boolean
    - jsonPath: .status.detectedOperators.secretsStoreCSI.installed
      name: SSCSI
      type: boolean
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1alpha1
    schema:
      openAPIV3Schema:
        description: SecretsManagementConfig is the Schema for the secretsmanagementconfigs
          API
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: SecretsManagementConfigSpec defines the desired state of
              SecretsManagementConfig
            properties:
              features:
                description: Features defines UI feature toggles
                properties:
                  create:
                    description: Create operation settings (future feature)
                    properties:
                      checkRBAC:
                        default: true
                        description: CheckRBAC determines if the UI should check user
                          RBAC via SelfSubjectAccessReview
                        type: boolean
                      enabled:
                        default: true
                        description: Enabled is the master switch for this feature
                        type: boolean
                    type: object
                  delete:
                    description: Delete operation settings
                    properties:
                      checkRBAC:
                        default: true
                        description: CheckRBAC determines if the UI should check user
                          RBAC via SelfSubjectAccessReview
                        type: boolean
                      enabled:
                        default: true
                        description: Enabled is the master switch for this feature
                        type: boolean
                    type: object
                  edit:
                    description: Edit operation settings (future feature)
                    properties:
                      checkRBAC:
                        default: true
                        description: CheckRBAC determines if the UI should check user
                          RBAC via SelfSubjectAccessReview
                        type: boolean
                      enabled:
                        default: true
                        description: Enabled is the master switch for this feature
                        type: boolean
                    type: object
                type: object
              operators:
                description: Operators defines per-operator configuration
                properties:
                  certManager:
                    description: CertManager settings for cert-manager operator
                    properties:
                      enabled:
                        default: true
                        description: Enabled determines if this operator's resources
                          should be shown in the UI
                        type: boolean
                    type: object
                  externalSecrets:
                    description: ExternalSecrets settings for External Secrets Operator
                    properties:
                      enabled:
                        default: true
                        description: Enabled determines if this operator's resources
                          should be shown in the UI
                        type: boolean
                    type: object
                  secretsStoreCSI:
                    description: SecretsStoreCSI settings for Secrets Store CSI Driver
                    properties:
                      enabled:
                        default: true
                        description: Enabled determines if this operator's resources
                          should be shown in the UI
                        type: boolean
                    type: object
                type: object
              plugin:
                description: Plugin defines the console plugin deployment settings
                properties:
                  image:
                    description: Image is the container image for the console plugin
                    type: string
                    minLength: 1
                    pattern: '^[a-zA-Z0-9][a-zA-Z0-9._/-]*(:[a-zA-Z0-9._-]+)?(@sha256:[a-f0-9]{64})?$'
                  imagePullPolicy:
                    default: IfNotPresent
                    description: ImagePullPolicy defines when to pull the image
                    enum:
                    - Always
                    - IfNotPresent
                    - Never
                    type: string
                  replicas:
                    default: 2
                    description: Replicas is the number of plugin deployment replicas
                    format: int32
                    minimum: 1
                    type: integer
                  resources:
                    description: Resources defines the resource requirements for the
                      plugin container
                    properties:
                      limits:
                        description: Limits defines the maximum resources allowed
                        properties:
                          cpu:
                            description: CPU resource requirement
                            type: string
                          memory:
                            description: Memory resource requirement
                            type: string
                        type: object
                      requests:
                        description: Requests defines the minimum resources required
                        properties:
                          cpu:
                            description: CPU resource requirement
                            type: string
                          memory:
                            description: Memory resource requirement
                            type: string
                        type: object
                    type: object
                type: object
              rbac:
                description: RBAC defines RBAC resources managed by the operator
                properties:
                  createDefaultRoles:
                    default: true
                    description: CreateDefaultRoles determines if the operator should
                      create default ClusterRoles
                    type: boolean
                  rolePrefix:
                    default: secrets-management
                    description: RolePrefix is the prefix for generated RBAC resource
                      names
                    type: string
                type: object
            type: object
          status:
            description: SecretsManagementConfigStatus defines the observed state
              of SecretsManagementConfig
            properties:
              conditions:
                description: Conditions represent the latest available observations
                items:
                  description: Condition represents an observation of the config's
                    state
                  properties:
                    lastTransitionTime:
                      description: LastTransitionTime is the last time the condition
                        transitioned
                      format: date-time
                      type: string
                    message:
                      description: Message is a human-readable message for the condition
                      type: string
                    reason:
                      description: Reason is a machine-readable reason for the condition
                      type: string
                    status:
                      description: Status of the condition (True, False, Unknown)
                      enum:
                      - "True"
                      - "False"
                      - Unknown
                      type: string
                    type:
                      description: Type of condition
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              detectedOperators:
                description: DetectedOperators contains detection status of operators
                properties:
                  certManager:
                    description: CertManager detection status
                    properties:
                      installed:
                        description: Installed indicates whether the operator's CRDs
                          are installed
                        type: boolean
                      version:
                        description: Version is the detected operator version
                        type: string
                    type: object
                  externalSecrets:
                    description: ExternalSecrets detection status
                    properties:
                      installed:
                        description: Installed indicates whether the operator's CRDs
                          are installed
                        type: boolean
                      version:
                        description: Version is the detected operator version
                        type: string
                    type: object
                  secretsStoreCSI:
                    description: SecretsStoreCSI detection status
                    properties:
                      installed:
                        description: Installed indicates whether the operator's CRDs
                          are installed
                        type: boolean
                      version:
                        description: Version is the detected operator version
                        type: string
                    type: object
                type: object
              observedGeneration:
                description: ObservedGeneration is the last observed generation of
                  the spec
                format: int64
                type: integer
              phase:
                description: Phase is the overall status of the deployment
                enum:
                - Pending
                - Deploying
                - Ready
                - Degraded
                - Error
                type: string
              plugin:
                description: Plugin contains status of the console plugin deployment
                properties:
                  availableReplicas:
                    description: AvailableReplicas is the number of available replicas
                    format: int32
                    type: integer
                  consolePluginName:
                    description: ConsolePluginName is the name of the ConsolePlugin
                      CR
                    type: string
                  deploymentName:
                    description: DeploymentName is the name of the plugin Deployment
                    type: string
                  ready:
                    description: Ready indicates whether the plugin is ready
                    type: boolean
                  serviceName:
                    description: ServiceName is the name of the plugin Service
                    type: string
                type: object
              rbac:
                description: RBAC contains status of RBAC resources
                properties:
                  clusterRoles:
                    description: ClusterRoles created by the operator
                    items:
                      description: ClusterRoleStatus represents a ClusterRole created
                        by the operator
                      properties:
                        created:
                          description: Created is the timestamp when the role was
                            created
                          format: date-time
                          type: string
                        name:
                          description: Name of the ClusterRole
                          type: string
                        operations:
                          description: Operations this role grants (e.g., "view",
                            "delete", "admin")
                          items:
                            type: string
                          type: array
                      type: object
                    type: array
                type: object
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
